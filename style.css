/* ============================================
   指南(Jinam) in Jamsil - K-VIBE 蠶室指南
   Design System: K-Pop High-Density Vitality
   #Vibrant #Trustworthy #Efficient #Fan-Centric
   ============================================ */

/* ---------- 1. Design Tokens ---------- */
:root {
    /* Color Palette */
    --color-primary: #3B82F6;
    --color-primary-hover: #2563EB;
    --color-point: #FF2E63;
    --color-point-soft: rgba(255, 46, 99, 0.12);
    --color-bg: #FFFFFF;
    --color-bg-soft: #F8F9FA;
    --color-border: #E5E7EB;
    --color-border-light: #F3F4F6;
    --color-text: #111827;
    --color-text-secondary: #6B7280;
    --color-text-muted: #9CA3AF;
  
    /* Typography - Noto Sans TC (zh-TW), min 14px */
    --font-primary: "Noto Sans TC", "Inter", sans-serif;
    --text-xs: 0.75rem;   /* 12px - use sparingly */
    --text-sm: 0.875rem;  /* 14px min for zh-TW */
    --text-base: 1rem;
    --text-lg: 1.125rem;
    --text-xl: 1.25rem;
    --text-2xl: 1.5rem;
    --text-3xl: 1.875rem;
    --font-medium: 500;
    --font-semibold: 600;
    --font-bold: 700;
  
    /* Card & Components (Event-us inspired) */
    --radius-sm: 8px;
    --radius-md: 10px;
    --radius-xl: 12px;
    --radius-2xl: 16px;
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-card: 0 1px 3px 0 rgba(0, 0, 0, 0.08);
    --border-card: 1px solid var(--color-border-light);
  
    /* Layout - Mobile 390px baseline */
    --header-h: 56px;
    --tabbar-h: 64px;
    --content-px: 16px;
    --safe-bottom: env(safe-area-inset-bottom, 0);
  }
  
  /* ---------- 2. Reset & Base ---------- */
  *, *::before, *::after { box-sizing: border-box; }
  html {
    font-size: 16px;
    -webkit-text-size-adjust: 100%;
  }
  body {
    margin: 0;
    font-family: var(--font-primary);
    font-size: var(--text-sm);
    line-height: 1.5;
    color: var(--color-text);
    background: var(--color-bg);
    min-height: 100vh;
    padding-bottom: calc(var(--tabbar-h) + var(--safe-bottom));
  }
  img { max-width: 100%; height: auto; display: block; }
  a { color: var(--color-primary); text-decoration: none; }
  a:hover { text-decoration: underline; }
  button {
    font-family: inherit;
    font-size: inherit;
    cursor: pointer;
    border: none;
    background: none;
  }
  
  /* ---------- 3. Layout Shell ---------- */
  .app-shell {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  .main-content {
    flex: 1;
    padding: 0 var(--content-px) 24px;
    padding-top: 8px;
  }
  
  /* ---------- 4. Sticky Header ---------- */
  .sticky-header {
    position: sticky;
    top: 0;
    z-index: 100;
    height: var(--header-h);
    padding: 0 var(--content-px);
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--color-bg);
    border-bottom: 1px solid var(--color-border-light);
  }
  .header-logo {
    font-size: var(--text-lg);
    font-weight: var(--font-bold);
    color: var(--color-primary);
  }
  .header-title {
    font-size: var(--text-base);
    font-weight: var(--font-semibold);
    color: var(--color-text);
  }
  .header-actions {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  .lang-badge {
    padding: 4px 10px;
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
    font-weight: var(--font-medium);
    background: var(--color-bg-soft);
    color: var(--color-text-secondary);
  }
  .lang-badge.active {
    background: var(--color-primary);
    color: white;
  }
  .icon-btn {
    width: 40px;
    height: 40px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-md);
    color: var(--color-text-secondary);
  }
  .icon-btn:hover {
    background: var(--color-bg-soft);
    color: var(--color-primary);
  }
  .icon-btn svg { width: 22px; height: 22px; }
  
  /* ---------- 5. Bottom Tab Bar ---------- */
  .bottom-tabbar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: calc(var(--tabbar-h) + var(--safe-bottom));
    padding-bottom: var(--safe-bottom);
    background: var(--color-bg);
    border-top: 1px solid var(--color-border-light);
    display: flex;
    align-items: flex-start;
    justify-content: space-around;
    z-index: 100;
  }
  .tab-item {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 8px 4px;
    gap: 4px;
    font-size: var(--text-xs);
    color: var(--color-text-muted);
    min-height: var(--tabbar-h);
  }
  .tab-item svg { width: 24px; height: 24px; }
  .tab-item.active {
    color: var(--color-primary);
    font-weight: var(--font-medium);
  }
  .tab-item.active svg { stroke: var(--color-primary); }
  
  /* ---------- 6. Panels (show/hide by JS) ---------- */
  .panel {
    display: none;
    animation: panelFadeIn 0.25s ease-out;
  }
  .panel.active { display: block; }
  @keyframes panelFadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  /* ---------- 7. CON-001 Concert Dashboard ---------- */
  .today-banner {
    background: linear-gradient(135deg, var(--color-primary) 0%, #60A5FA 100%);
    color: white;
    padding: 14px 16px;
    border-radius: var(--radius-xl);
    margin-bottom: 16px;
    font-size: var(--text-base);
    font-weight: var(--font-medium);
  }
  .today-banner strong { font-weight: var(--font-bold); }
  .filter-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 16px;
  }
  .chip {
    padding: 8px 14px;
    border-radius: 9999px;
    font-size: var(--text-sm);
    font-weight: var(--font-medium);
    background: var(--color-bg-soft);
    color: var(--color-text-secondary);
    border: 1px solid transparent;
  }
  .chip:hover, .chip.active {
    background: var(--color-primary);
    color: white;
    border-color: var(--color-primary);
  }
  .concert-list { display: flex; flex-direction: column; gap: 12px; }
  
  /* Concert Card - Event-us style */
  .concert-card {
    background: var(--color-bg);
    border: var(--border-card);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-card);
    padding: 16px;
    transition: transform 0.2s, box-shadow 0.2s;
    cursor: pointer;
  }
  .concert-card:hover {
    transform: scale(1.02);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  }
  .concert-card .card-top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 10px;
  }
  .dday-badge {
    display: inline-flex;
    align-items: center;
    padding: 4px 10px;
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
    font-weight: var(--font-bold);
    background: var(--color-point);
    color: white;
  }
  .dday-badge.blue { background: var(--color-primary); }
  .card-date {
    font-size: var(--text-sm);
    color: var(--color-text-secondary);
  }
  .concert-card .artist {
    font-size: var(--text-lg);
    font-weight: var(--font-bold);
    color: var(--color-text);
    margin-bottom: 4px;
  }
  .concert-card .title {
    font-size: var(--text-base);
    color: var(--color-text-secondary);
    margin-bottom: 10px;
  }
  .concert-card .venue {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    margin-bottom: 12px;
  }
  .btn-view-detail {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 14px;
    border-radius: var(--radius-md);
    font-size: var(--text-sm);
    font-weight: var(--font-medium);
    background: var(--color-bg-soft);
    color: var(--color-primary);
  }
  .btn-view-detail:hover { background: rgba(59, 130, 246, 0.12); }
  
  /* ---------- 8. CON-002 Concert Detail ---------- */
  .detail-header {
    margin-bottom: 20px;
  }
  .detail-header .dday-badge { margin-bottom: 8px; }
  .detail-header .artist { font-size: var(--text-xl); margin-bottom: 4px; }
  .detail-header .title { font-size: var(--text-base); color: var(--color-text-secondary); }
  .detail-meta {
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 16px;
    background: var(--color-bg-soft);
    border-radius: var(--radius-xl);
    margin-bottom: 20px;
    font-size: var(--text-sm);
  }
  .detail-actions {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .detail-actions .btn-primary {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 14px 20px;
    border-radius: var(--radius-xl);
    font-size: var(--text-base);
    font-weight: var(--font-semibold);
    background: var(--color-primary);
    color: white;
  }
  .detail-actions .btn-primary:hover { background: var(--color-primary-hover); }
  .detail-actions .btn-outline {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 12px 20px;
    border-radius: var(--radius-xl);
    font-size: var(--text-sm);
    font-weight: var(--font-medium);
    border: 2px solid var(--color-border);
    color: var(--color-text);
  }
  .detail-actions .btn-outline:hover { border-color: var(--color-primary); color: var(--color-primary); }
  .btn-back {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 16px;
    font-size: var(--text-sm);
    color: var(--color-text-secondary);
  }
  .btn-back:hover { color: var(--color-primary); }
  
  /* ---------- 9. LIVE-001 Live Feed ---------- */
  .live-filter-row {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 16px;
  }
  .live-filter-row .chip { min-width: fit-content; }
  .feed-list { display: flex; flex-direction: column; gap: 16px; }
  
  /* Thread-style Feed Card */
  .feed-card {
    background: var(--color-bg);
    border: var(--border-card);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-card);
    overflow: hidden;
    transition: transform 0.2s;
  }
  .feed-card:hover { transform: scale(1.01); }
  .feed-card .card-head {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 8px;
    padding: 10px 14px;
    border-bottom: 1px solid var(--color-border-light);
  }
  .feed-card .category-tag {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: var(--text-xs);
    font-weight: var(--font-medium);
    color: var(--color-primary);
  }
  .feed-card .category-tag.merch { color: #059669; }
  .feed-card .category-tag.entrance { color: #D97706; }
  .feed-card .category-tag.atmosphere { color: #7C3AED; }
  .feed-card .feed-likes {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: var(--text-xs);
    color: var(--color-text-muted);
  }
  .feed-card .feed-likes svg { width: 14px; height: 14px; }
  .feed-card .timestamp { font-size: var(--text-xs); color: var(--color-text-muted); }
  .feed-card .card-image {
    aspect-ratio: 4 / 5;
    background: var(--color-bg-soft);
    object-fit: cover;
    width: 100%;
  }
  .feed-card .card-body {
    padding: 12px 14px;
  }
  .feed-card .card-desc {
    font-size: var(--text-sm);
    color: var(--color-text);
    margin-bottom: 6px;
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .feed-card .card-meta {
    font-size: var(--text-xs);
    color: var(--color-text-muted);
    margin-bottom: 12px;
  }
  .feed-card .card-actions {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 8px;
  }
  .btn-share {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 8px 12px;
    border-radius: var(--radius-md);
    font-size: var(--text-xs);
    font-weight: var(--font-medium);
    color: var(--color-text);
    border: 1px solid var(--color-border);
  }
  .btn-share:hover { border-color: var(--color-primary); color: var(--color-primary); }
  .btn-share svg { width: 14px; height: 14px; flex-shrink: 0; }
  .btn-share-threads { background: var(--color-text); color: white; border-color: transparent; }
  .btn-share-threads:hover { opacity: 0.9; color: white; }
  .btn-share-line { background: #06C755; color: white; border-color: #06C755; }
  .btn-share-line:hover { opacity: 0.9; color: white; }
  .btn-share-native {
    padding: 8px 12px;
    font-size: var(--text-xs);
    background: var(--color-bg-soft);
    color: var(--color-primary);
  }
  .btn-share-native:hover { background: rgba(59, 130, 246, 0.12); }
  
  /* ---------- 10. SET-001 More / Settings ---------- */
  .settings-section {
    margin-bottom: 24px;
  }
  .settings-section-title {
    font-size: var(--text-sm);
    font-weight: var(--font-semibold);
    color: var(--color-text-secondary);
    margin-bottom: 10px;
    padding-left: 4px;
  }
  .settings-list {
    background: var(--color-bg);
    border: var(--border-card);
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-card);
    overflow: hidden;
  }
  .settings-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 16px;
    border-bottom: 1px solid var(--color-border-light);
    font-size: var(--text-sm);
    color: var(--color-text);
  }
  .settings-item:last-child { border-bottom: none; }
  .settings-item a { display: flex; align-items: center; gap: 12px; width: 100%; color: inherit; }
  .settings-item a:hover { color: var(--color-primary); }
  .settings-item .icon-wrap {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-md);
    background: var(--color-bg-soft);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-primary);
  }
  .settings-item .icon-wrap svg { width: 20px; height: 20px; }
  .settings-item .label { flex: 1; font-weight: var(--font-medium); }
  .settings-item .sublabel { font-size: var(--text-xs); color: var(--color-text-muted); margin-top: 2px; }
  .settings-item .chevron { color: var(--color-text-muted); }
  .settings-item .chevron svg { width: 18px; height: 18px; }
  
  .lang-switcher-row {
    display: flex;
    gap: 10px;
    padding: 14px 16px;
  }
  .lang-option {
    flex: 1;
    padding: 10px 16px;
    border-radius: var(--radius-md);
    font-size: var(--text-sm);
    font-weight: var(--font-medium);
    text-align: center;
    border: 2px solid var(--color-border);
    color: var(--color-text-secondary);
  }
  .lang-option.active {
    border-color: var(--color-primary);
    background: rgba(59, 130, 246, 0.08);
    color: var(--color-primary);
  }
  
  .community-desc {
    padding: 10px 16px 4px;
    font-size: var(--text-xs);
    color: var(--color-text-muted);
  }
  
  .settings-footer {
    margin-top: 32px;
    padding-top: 24px;
    border-top: 1px solid var(--color-border-light);
    text-align: center;
    font-size: var(--text-xs);
    color: var(--color-text-muted);
  }
  .settings-footer .social-icons {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin-bottom: 12px;
  }
  .settings-footer .social-icons a { color: var(--color-text-muted); }
  .settings-footer .social-icons a:hover { color: var(--color-primary); }
  .settings-footer .social-icons svg { width: 22px; height: 22px; }
  
  /* ---------- 11. Map Placeholder ---------- */
  .map-placeholder {
    min-height: 320px;
    background: var(--color-bg-soft);
    border-radius: var(--radius-xl);
    border: 2px dashed var(--color-border);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 12px;
    color: var(--color-text-muted);
    font-size: var(--text-sm);
    padding: 24px;
    text-align: center;
  }
  .map-placeholder svg { width: 48px; height: 48px; opacity: 0.6; }
  .map-placeholder-title { font-weight: var(--font-semibold); color: var(--color-text-secondary); }
  .map-placeholder-desc { font-size: var(--text-xs); max-width: 280px; }
  .map-legend {
    list-style: none;
    margin: 16px 0 0;
    padding: 0;
    text-align: left;
    font-size: var(--text-xs);
    color: var(--color-text-secondary);
  }
  .map-legend li { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; }
  .map-legend-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    flex-shrink: 0;
  }
  .map-legend-locker { background: var(--color-primary); }
  .map-legend-water { background: #0EA5E9; }
  .map-legend-merch { background: var(--color-point); }
  .settings-footer .footer-tz { margin-top: 6px; font-size: 0.7rem; opacity: 0.9; }
  
  /* ---------- 12. Utility ---------- */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0,0,0,0);
    white-space: nowrap;
    border: 0;
  }
  
  @media (min-width: 768px) {
    body { padding-bottom: 0; }
    .bottom-tabbar {
      position: relative;
      max-width: 480px;
      margin: 0 auto;
      border-radius: var(--radius-2xl) var(--radius-2xl) 0 0;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.06);
    }
    .main-content { max-width: 480px; margin: 0 auto; }
    .sticky-header { max-width: 480px; margin: 0 auto; }
  }
  